if (buffer == NULL) {
    //     printf("Memory allocation failed!\n");
    //     return NULL; // Return NULL if allocation fails
    // }